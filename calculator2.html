<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scientific Calculator</title>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --danger-color: #e74c3c;
            --success-color: #2ecc71;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        
        .calculator {
            width: 340px;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        .display {
            padding: 20px;
            text-align: right;
            background-color: var(--dark-color);
            color: white;
            position: relative;
        }
        
        .previous-operand {
            font-size: 1.2rem;
            height: 24px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 8px;
            overflow: hidden;
        }
        
        .current-operand {
            font-size: 2.5rem;
            font-weight: bold;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1px;
            background-color: #ddd;
            grid-template-areas: 
                "func1 func2 func3 func4 func5"
                "func6 func7 func8 func9 func10"
                "clear clear del percent divide"
                "seven eight nine times minus"
                "four five six plus plus"
                "one two three equals equals"
                "zero zero decimal power factorial";
        }
        
        button {
            border: none;
            outline: none;
            padding: 20px;
            font-size: 1.2rem;
            cursor: pointer;
            background-color: white;
            transition: all 0.2s;
        }
        
        button:hover {
            background-color: #f1f1f1;
        }
        
        button:active {
            transform: scale(0.95);
        }
        
        .operator {
            background-color: var(--light-color);
            font-weight: bold;
        }
        
        .equals {
            background-color: var(--primary-color);
            color: white;
        }
        
        .equals:hover {
            background-color: var(--secondary-color);
        }
        
        .function {
            background-color: var(--light-color);
            font-size: 1rem;
        }
        
        .clear, .delete {
            color: white;
        }
        
        .clear {
            background-color: var(--danger-color);
        }
        
        .clear:hover {
            background-color: #c0392b;
        }
        
        .delete {
            background-color: var(--success-color);
        }
        
        .delete:hover {
            background-color: #27ae60;
        }
        
        .span-2 {
            grid-column: span 2;
        }
        
        .active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .secondary-active {
            background-color: var(--secondary-color);
            color: white;
        }

        /* Mobile styles */
        @media (max-width: 480px) {
            .calculator {
                width: 100%;
                border-radius: 0;
            }
            
            .buttons {
                grid-template-columns: repeat(4, 1fr);
                grid-template-areas: 
                    "func1 func2 func3 func4"
                    "func5 func6 func7 func8"
                    "func9 func10 clear del"
                    "percent divide times minus"
                    "plus power factorial equals"
                    "seven eight nine equals"
                    "four five six equals"
                    "one two three equals"
                    "zero zero decimal equals";
            }
            
            button {
                padding: 15px 5px;
                font-size: 1rem;
            }
            
            /* Specific button positioning */
            .func1 { grid-area: func1; }
            .func2 { grid-area: func2; }
            .func3 { grid-area: func3; }
            .func4 { grid-area: func4; }
            .func5 { grid-area: func5; }
            .func6 { grid-area: func6; }
            .func7 { grid-area: func7; }
            .func8 { grid-area: func8; }
            .func9 { grid-area: func9; }
            .func10 { grid-area: func10; }
            .clear { grid-area: clear; }
            .delete { grid-area: del; }
            .operator[onclick*="'%'"] { grid-area: percent; }
            .operator[onclick*="'/'"] { grid-area: divide; }
            .operator[onclick*="'*'"] { grid-area: times; }
            .operator[onclick*="'-'"] { grid-area: minus; }
            .operator[onclick*="'+'"] { grid-area: plus; }
            [onclick*="'7'"] { grid-area: seven; }
            [onclick*="'8'"] { grid-area: eight; }
            [onclick*="'9'"] { grid-area: nine; }
            [onclick*="'4'"] { grid-area: four; }
            [onclick*="'5'"] { grid-area: five; }
            [onclick*="'6'"] { grid-area: six; }
            [onclick*="'1'"] { grid-area: one; }
            [onclick*="'2'"] { grid-area: two; }
            [onclick*="'3'"] { grid-area: three; }
            [onclick*="'0'"] { grid-area: zero; }
            [onclick*="'.'"] { grid-area: decimal; }
            [onclick*="'**'"] { grid-area: power; }
            [onclick*="'!'"] { grid-area: factorial; }
            .equals { grid-area: equals; }
        }
    </style>
</head>
<body>
    <div class="calculator">
        <div class="display">
            <div class="previous-operand" id="previous-operand"></div>
            <div class="current-operand" id="current-operand">0</div>
        </div>
        <div class="buttons">
            <button class="function func1" onclick="calculateFunction('sin(')">sin</button>
            <button class="function func2" onclick="calculateFunction('cos(')">cos</button>
            <button class="function func3" onclick="calculateFunction('tan(')">tan</button>
            <button class="function func4" onclick="calculateFunction('log(')">log</button>
            <button class="function func5" onclick="calculateFunction('ln(')">ln</button>
            
            <button class="function func6" onclick="calculateFunction('Math.PI')">π</button>
            <button class="function func7" onclick="calculateFunction('Math.E')">e</button>
            <button class="function func8" onclick="calculateFunction('Math.sqrt(')">√</button>
            <button class="function func9" onclick="calculateFunction('(')">(</button>
            <button class="function func10" onclick="calculateFunction(')')">)</button>
            
            <button class="clear" onclick="clearAll()">AC</button>
            <button class="delete" onclick="deleteLast()">DEL</button>
            <button class="operator" onclick="appendOperator('%')">%</button>
            <button class="operator" onclick="appendOperator('/')">/</button>
            
            <button onclick="appendNumber('7')">7</button>
            <button onclick="appendNumber('8')">8</button>
            <button onclick="appendNumber('9')">9</button>
            <button class="operator" onclick="appendOperator('*')">×</button>
            
            <button onclick="appendNumber('4')">4</button>
            <button onclick="appendNumber('5')">5</button>
            <button onclick="appendNumber('6')">6</button>
            <button class="operator" onclick="appendOperator('-')">-</button>
            
            <button onclick="appendNumber('1')">1</button>
            <button onclick="appendNumber('2')">2</button>
            <button onclick="appendNumber('3')">3</button>
            <button class="operator" onclick="appendOperator('+')">+</button>
            
            <button class="function" onclick="appendNumber('0')">0</button>
            <button onclick="appendNumber('.')">.</button>
            <button class="function" onclick="calculateFunction('**')">^</button>
            <button class="function" onclick="calculateFunction('!')">!</button>
            <button class="equals span-2" onclick="calculate()">=</button>
        </div>
    </div>

    <script>
        let currentOperand = '0';
        let previousOperand = '';
        let operation = undefined;
        let resetScreen = false;

        const currentOperandElement = document.getElementById('current-operand');
        const previousOperandElement = document.getElementById('previous-operand');

        function appendNumber(number) {
            if (currentOperand === '0' || resetScreen) {
                currentOperand = '';
                resetScreen = false;
            }
            
            if (number === '.' && currentOperand.includes('.')) return;
            
            currentOperand += number;
            updateDisplay();
        }

        function appendOperator(operator) {
            if (currentOperand === '' && previousOperand !== '') {
                operation = operator;
                updateDisplay();
                return;
            }
            
            if (currentOperand === '') return;
            
            if (previousOperand !== '') {
                calculate();
            }
            
            operation = operator;
            previousOperand = currentOperand;
            currentOperand = '';
            updateDisplay();
        }

        function calculateFunction(func) {
            if (func === '!') {
                // Factorial calculation
                const num = parseFloat(currentOperand);
                if (num < 0) {
                    currentOperand = 'Error';
                    updateDisplay();
                    return;
                }
                
                let result = 1;
                for (let i = 2; i <= num; i++) {
                    result *= i;
                }
                currentOperand = result.toString();
            } else if (func === '**') {
                // Power operator
                operation = '**';
                previousOperand = currentOperand;
                currentOperand = '';
            } else {
                // Other functions
                currentOperand = func + currentOperand;
                if (['sin(', 'cos(', 'tan(', 'log(', 'ln(', 'Math.sqrt('].includes(func)) {
                    currentOperand += ')';
                }
            }
            updateDisplay();
        }

        function calculate() {
            let computation;
            const prev = parseFloat(previousOperand);
            const current = parseFloat(currentOperand);
            
            if (isNaN(prev) || isNaN(current)) return;
            
            try {
                switch (operation) {
                    case '+':
                        computation = prev + current;
                        break;
                    case '-':
                        computation = prev - current;
                        break;
                    case '*':
                        computation = prev * current;
                        break;
                    case '/':
                        computation = prev / current;
                        break;
                    case '%':
                        computation = prev % current;
                        break;
                    case '**':
                        computation = Math.pow(prev, current);
                        break;
                    default:
                        // Try to evaluate as a mathematical expression
                        try {
                            computation = eval(previousOperand + operation + currentOperand);
                        } catch (e) {
                            computation = 'Error';
                        }
                }
                
                currentOperand = computation.toString();
                operation = undefined;
                previousOperand = '';
                resetScreen = true;
            } catch (error) {
                currentOperand = 'Error';
            }
            
            updateDisplay();
        }

        function clearAll() {
            currentOperand = '0';
            previousOperand = '';
            operation = undefined;
            updateDisplay();
        }

        function deleteLast() {
            if (currentOperand.length === 1 || (currentOperand.length === 2 && currentOperand.startsWith('-'))) {
                currentOperand = '0';
            } else {
                currentOperand = currentOperand.slice(0, -1);
            }
            updateDisplay();
        }

        function updateDisplay() {
            currentOperandElement.textContent = currentOperand;
            
            if (operation != null) {
                previousOperandElement.textContent = `${previousOperand} ${operation}`;
            } else {
                previousOperandElement.textContent = previousOperand;
            }
        }

        // Keyboard support
        document.addEventListener('keydown', (e) => {
            if (e.key >= '0' && e.key <= '9') appendNumber(e.key);
            else if (e.key === '.') appendNumber('.');
            else if (e.key === '+' || e.key === '-' || e.key === '*' || e.key === '/' || e.key === '%') 
                appendOperator(e.key);
            else if (e.key === 'Enter' || e.key === '=') calculate();
            else if (e.key === 'Escape') clearAll();
            else if (e.key === 'Backspace') deleteLast();
            else if (e.key === '^') calculateFunction('**');
            else if (e.key === '!') calculateFunction('!');
        });
    </script>
</body>
</html>